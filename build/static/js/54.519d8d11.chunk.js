"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[54],{803105:(e,n,t)=>{t.d(n,{Z:()=>o});var l=t(624631),i=t(876767),s=t(648623),r=t(346417);const d=(0,i.D)();const o=function(e){let{value:n,setValue:t,options:i,title:o,propr:a}=e;return(0,r.jsx)(s.Z,{value:n,onChange:(e,n)=>{"string"===typeof n?t({title:n}):n&&n.inputValue?t({title:n.inputValue}):t(n)},filterOptions:(e,n)=>d(e,n),selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,id:"free-solo-with-text-demo",options:i,getOptionLabel:e=>"string"===typeof e?e:e.inputValue?e.inputValue:e[""+a],renderOption:(e,n)=>(0,r.jsx)("li",{...e,children:n[""+a]}),sx:{width:"100%"},freeSolo:!0,renderInput:e=>(0,r.jsx)(l.Z,{...e,label:o||"Titre"})})}},792628:(e,n,t)=>{t.d(n,{Z:()=>x});var l=t(747313),i=t(582294),s=t(565280),r=t(261113),d=t(557829),o=t(346417);function a(e){const{children:n,value:t,index:l,...i}=e;return(0,o.jsx)("div",{role:"tabpanel",hidden:t!==l,id:"simple-tabpanel-".concat(l),"aria-labelledby":"simple-tab-".concat(l),...i,children:t===l&&(0,o.jsx)(d.Z,{sx:{p:3},children:(0,o.jsx)(r.Z,{component:"div",children:n})})})}function c(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function h(e){let{titres:n,components:t}=e;const[r,h]=l.useState(0);return(0,o.jsxs)(d.Z,{sx:{width:"100%"},children:[(0,o.jsx)(d.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,o.jsx)(i.Z,{value:r,onChange:(e,n)=>{h(n)},"aria-label":"icon label tabs example",style:{padding:"0px",margin:"0px"},children:n.map(((e,n)=>(0,l.createElement)(s.Z,{label:e.label,...c(e.id),key:n})))})}),t.map(((e,n)=>(0,o.jsx)(a,{value:r,index:e.id,children:e.component},n)))]})}const x=l.memo(h)},688054:(e,n,t)=>{t.r(n),t.d(n,{default:()=>X});var l=t(747313),i=t(185554),s=t(803105),r=t(799881),d=t(809019),o=t(369099),a=t(435045),c=t(71978),h=t(560623),x=t(337169),p=t(326236),u=t(75767),j=t(942450),g=t(763743),m=t(573203),f=t(75854),v=t(416031),Z=t.n(v),y=t(346417);function b(e){let{donner:n,recherche:t}=e;const[i,s]=(0,l.useState)({datas:[]}),{datas:r}=i;return(0,l.useEffect)((()=>{(()=>{let e=[];const t=Z().groupBy(n,"zone.denomination");let l=Object.keys(t);for(let n=0;n<l.length;n++)e.push({region:l[n],agent:t[""+l[n]].filter((e=>"agent"===e.agent.fonction)).length,tech:t[""+l[n]].filter((e=>"tech"===e.agent.fonction)).length});s({datas:e})})()}),[n]),(0,y.jsx)(d.ZP,{container:!0,sx:{height:"25rem"},children:(0,y.jsx)(d.ZP,{item:!0,lg:12,children:!t.codeAgent&&(0,y.jsx)(c.h,{width:"100%",children:(0,y.jsxs)(h.v,{data:r,children:[(0,y.jsx)(x.q,{strokeDasharray:"3 3"}),(0,y.jsx)(p.K,{dataKey:"region"}),(0,y.jsx)(u.B,{}),(0,y.jsx)(j.u,{}),(0,y.jsx)(g.D,{}),(0,y.jsx)(m.$,{dataKey:"agent",fill:"#8884d8",activeBar:(0,y.jsx)(f.A,{fill:"pink",stroke:"blue"})}),(0,y.jsx)(m.$,{dataKey:"tech",fill:"#82ca9d",activeBar:(0,y.jsx)(f.A,{fill:"gold",stroke:"purple"})})]})})})})}const S=(0,l.memo)(b);var C=t(835662),A=t(661395),P=t(792628),D=t(209478);const N=function(e){let{listeDemande:n,region:t}=e;console.log(t);const l=(e,t,l)=>{try{return(n&&n.filter((e=>e.reponse.length>0))).filter((n=>n.reponse[0].clientStatut===t&&n.reponse[0].PayementStatut===l&&n.codeZone===e)).length}catch(i){console.log(i)}},i=e=>{try{let t=n&&n.filter((n=>n.codeZone===e));return{total:t.length,pourcentage:(100*t.length/n.length).toFixed(0)}}catch(t){console.log(t)}};return(0,y.jsx)("div",{children:(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)("table",{children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{style:{background:"#dedede"},children:[(0,y.jsx)("td",{children:"Region"}),(0,y.jsx)("td",{children:"Statut du client"}),(0,y.jsx)("td",{children:"Statut payement"}),(0,y.jsx)("td",{children:"Nombre"}),(0,y.jsx)("td",{children:"En attente"})]})}),(0,y.jsxs)("tbody",{children:[(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{rowSpan:"7",children:t.denomination}),(0,y.jsx)("td",{children:"installed"}),(0,y.jsx)("td",{children:"Normal"}),(0,y.jsx)("td",{children:l(t.idZone,"installed","normal")}),(0,y.jsx)("td",{rowSpan:"6",style:{fontSize:"25px",fontWeight:"bolder"},children:(e=>{try{return(n&&n.filter((e=>0===e.reponse.length))).filter((n=>n.codeZone===e)).length}catch(t){console.log(t)}})(t.idZone)})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:"installed"}),(0,y.jsx)("td",{children:"expired"}),(0,y.jsx)("td",{children:l(t.idZone,"installed","expired")})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:"installed"}),(0,y.jsx)("td",{children:"Defaulted"}),(0,y.jsx)("td",{children:l(t.idZone,"installed","defaulted")})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:"pending repossession"}),(0,y.jsx)("td",{children:"defaulted"}),(0,y.jsx)("td",{children:l(t.idZone,"pending repossession","defaulted")})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:"pending activation"}),(0,y.jsx)("td",{children:"pending fulfliment"}),(0,y.jsx)("td",{children:l(t.idZone,"pending activation","pending fulfliment")})]}),(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:"inactive"}),(0,y.jsx)("td",{children:"terminated"}),(0,y.jsx)("td",{children:l(t.idZone,"inactive","terminated")})]}),(0,y.jsxs)("tr",{style:{background:"#dedede"},children:[(0,y.jsx)("td",{colSpan:"3",children:"Total"}),(0,y.jsxs)("td",{style:{padding:"0px",margin:"0px",fontWeight:"bolder"},children:[(0,y.jsx)("span",{style:{fontSize:"15px"},children:i(t.idZone).total}),(0,y.jsxs)("span",{children:[" "," Soit "+i(t.idZone).pourcentage,"%"]})]})]})]})]})})})};var z=t(261113),k=t(861689),w=t(542420),B=t(372541),T=t(334811),L=t(582294),W=t(565280),R=t(557829),V=t(70816),_=t.n(V),F=t(323870);const O=function(e){let{data:n}=e;const[t,i]=l.useState({fn:e=>e});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(d.ZP,{container:!0,sx:{marginBottom:"10px"},children:(0,y.jsx)(d.ZP,{item:!0,lg:8,children:(0,y.jsx)(F.default,{type:"text",onChange:e=>(e=>{let n=e.target.value.toUpperCase();i({fn:e=>""===n?e:e.filter((e=>e.reponse[0].codeclient.includes(n)||e.reponse[0].nomClient.includes(n)))})})(e),placeholder:"Code client ou nom du client"})})}),(0,y.jsx)(d.ZP,{container:!0,children:n&&t.fn((e=>{try{return e.filter((e=>e.reponse.length>0))}catch(n){return[]}})(n)).map((e=>(0,y.jsxs)(d.ZP,{item:!0,lg:6,className:"messagesToutes",children:[(0,y.jsxs)("div",{className:"listeImage",children:[(0,y.jsx)("img",{src:"".concat(A.BP,"/").concat(e.file),alt:e._id}),(0,y.jsxs)(z.Z,{component:"p",sx:{fontSize:"13px"},children:[void 0!==e.codeclient&&e.codeclient,";",null===e||void 0===e?void 0:e.sat," ",null===e||void 0===e?void 0:e.reference,null===e||void 0===e?void 0:e.statut,"; ",null===e||void 0===e?void 0:e.raison.toLowerCase(),", ",e.numero&&e.numero,";"]})]}),(0,y.jsx)("div",{className:"itemButtons"}),(0,y.jsx)("div",{children:e.conversation.length>0&&e.conversation.map((e=>(0,y.jsxs)("div",{className:"agent"===e.sender?"agent":"callcenter",children:[(0,y.jsx)("p",{className:"messageText",children:e.message}),(0,y.jsx)("p",{className:"heure",children:_()(e.createdAt).fromNow()})]},e._id)))}),(0,y.jsx)("div",{children:e.reponse.length>0&&e.reponse.map((e=>(0,y.jsxs)("div",{className:"reponseListe",children:[(0,y.jsx)("p",{children:e.codeclient}),(0,y.jsx)("p",{style:{fontWeight:"bold"},children:e.nomClient.toUpperCase()}),(0,y.jsxs)("p",{children:["Statut du client : ",(0,y.jsx)("span",{style:{fontWeight:"bolder"},children:e.clientStatut})," "]}),(0,y.jsxs)("p",{children:["Statut payement : ",(0,y.jsx)("span",{style:{fontWeight:"bolder"},children:e.PayementStatut})]}),(0,y.jsxs)("p",{children:["consExpDays :"," ",(0,y.jsxs)("span",{style:{fontWeight:"bolder"},children:[e.consExpDays," jour(s) "]})]}),(0,y.jsxs)("p",{children:[e.region,"/",e.shop]}),(0,y.jsx)("p",{children:null===e||void 0===e?void 0:e.codeCu})]},e._id)))})]},e._id)))}),n&&0===n.length&&(0,y.jsx)("p",{style:{fontSize:"12px",marginTop:"20px",textAlign:"center",color:"red"},children:"Aucune demande trouv\xe9e"})]})};var E=t(396180);const I=function(e){let{data:n}=e;const[t,i]=E.ZP.useMessage(),[s,r]=l.useState({fn:e=>e});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(y.Fragment,{children:i}),(0,y.jsx)(d.ZP,{container:!0,sx:{marginBottom:"10px"},children:(0,y.jsx)(d.ZP,{item:!0,lg:8,children:(0,y.jsx)(F.default,{type:"text",onChange:e=>(e=>{let n=e.target.value.toUpperCase();r({fn:e=>""===n?e:e.filter((e=>e.codeclient.includes(n)))})})(e),placeholder:"Code client ou ID demande"})})}),(0,y.jsx)(d.ZP,{container:!0,children:n&&s.fn((e=>{try{return e.filter((e=>0===e.reponse.length))}catch(n){return[]}})(n)).map((e=>(0,y.jsxs)(d.ZP,{item:!0,lg:12,className:"messagesToutes",children:[(0,y.jsxs)("div",{className:"listeImage",children:[(0,y.jsx)("img",{src:"".concat(A.BP,"/").concat(e.file),alt:e._id}),(0,y.jsxs)(z.Z,{component:"p",sx:{fontSize:"13px"},children:[(0,y.jsxs)(z.Z,{children:["ID : ",e.idDemande,(0,y.jsx)(z.Z,{component:"span",onClick:()=>{return n=e.idDemande,navigator.clipboard.writeText(n),void t.open({type:"success",content:"Done "+n,duration:2});var n},style:{marginLeft:"10px",color:"blue",fontWeight:"bolder",cursor:"pointer",textAlign:"center"},children:"copy ID"}),(0,y.jsx)("span",{style:{float:"right",fontSize:"10px"},children:_()(e.createdAt).fromNow()})]}),void 0!==e.codeclient&&e.codeclient,";",null===e||void 0===e?void 0:e.sat," ",null===e||void 0===e?void 0:e.reference,null===e||void 0===e?void 0:e.statut,"; ",null===e||void 0===e?void 0:e.raison.toLowerCase(),", ",e.numero&&e.numero,";"]})]}),(0,y.jsx)("div",{className:"itemButtons"}),(0,y.jsx)("div",{children:e.conversation.length>0&&e.conversation.map((e=>(0,y.jsxs)("div",{className:"agent"===e.sender?"agent":"callcenter",children:[(0,y.jsx)("p",{className:"messageText",children:e.message}),(0,y.jsx)("p",{className:"heure",children:_()(e.createdAt).fromNow()})]},e._id)))})]},e._id)))}),n&&0===n.length&&(0,y.jsx)("p",{style:{fontSize:"12px",marginTop:"20px",textAlign:"center",color:"red"},children:"Aucune demande trouv\xe9e"})]})};function q(e){const{children:n,value:t,index:l,...i}=e;return(0,y.jsx)("div",{role:"tabpanel",hidden:t!==l,id:"simple-tabpanel-".concat(l),"aria-labelledby":"simple-tab-".concat(l),...i,children:t===l&&(0,y.jsx)(R.Z,{sx:{p:3},children:(0,y.jsx)(z.Z,{children:n})})})}function K(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function M(e){let{data:n}=e;const[t,i]=l.useState(0);return(0,y.jsxs)(R.Z,{sx:{width:"100%",minWidth:"30rem"},children:[(0,y.jsx)(R.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,y.jsxs)(L.Z,{value:t,onChange:(e,n)=>{i(n)},"aria-label":"basic tabs example",children:[(0,y.jsx)(W.Z,{label:"Valide",...K(0)}),(0,y.jsx)(W.Z,{label:"Attente",...K(1)})]})}),(0,y.jsx)(q,{value:t,index:0,children:(0,y.jsx)(O,{data:n})}),(0,y.jsx)(q,{value:t,index:1,children:(0,y.jsx)(I,{data:n})})]})}const U=function(e){let{listeDemande:n}=e;const[t,i]=l.useState(),[s,r]=l.useState(!1),[d,o]=l.useState();return l.useEffect((()=>{(()=>{const e=Z().groupBy(n,"codeAgent");try{let t=[],l=Object.keys(e);for(let e=0;e<l.length;e++)t.push({nom:n.filter((n=>n.agent.codeAgent===l[e]))[0].agent.nom,code:l[e],nonRepondu:n.filter((n=>n.agent.codeAgent===l[e]&&0===n.reponse.length)).length,repondu:n.filter((n=>n.agent.codeAgent===l[e]&&n.reponse.length>0)).length,total:n.filter((n=>n.agent.codeAgent===l[e])).length});i(Z().orderBy(t,"total","desc"))}catch(t){console.log(t)}})()}),[n]),(0,y.jsxs)("div",{children:[(0,y.jsxs)("table",{children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:"Nom Agent"}),(0,y.jsx)("td",{children:"Code agent"}),(0,y.jsx)("td",{children:"Repondue(s)"}),(0,y.jsx)("td",{children:"Attente(s)"}),(0,y.jsx)("td",{children:"Max"}),(0,y.jsx)("td",{children:"D\xe9tails"})]})}),(0,y.jsx)("tbody",{children:t?t.map((e=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{className:"nom",children:(0,y.jsx)(z.Z,{noWrap:!0,component:"span",fontSize:"12px",children:e.nom})}),(0,y.jsx)("td",{children:e.code}),(0,y.jsx)("td",{children:e.repondu}),(0,y.jsx)("td",{children:e.nonRepondu}),(0,y.jsx)("td",{children:e.total}),(0,y.jsx)("td",{children:(0,y.jsx)(k.Z,{title:"Plus les d\xe9tails",onClick:t=>((e,t)=>{e.preventDefault(),o(Z().filter(n,{codeAgent:t})),r(!0)})(t,e.code),children:(0,y.jsx)(w.Z,{size:"small",color:"primary",children:(0,y.jsx)(B.default,{fontSize:"small"})})})})]},e.code))):(0,y.jsx)("tr",{children:(0,y.jsx)("td",{children:"Loading..."})})})]}),d&&(0,y.jsx)(T.Z,{open:s,setOpen:r,title:"pour ".concat(d[0].agent.nom," -------- code : ").concat(d[0].agent.codeAgent),children:(0,y.jsx)(M,{data:d})})]})};const $=function(e){let{listeDemande:n}=e;return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("div",{className:"statDemande",children:n&&(0,y.jsxs)("p",{style:{textAlign:"center"},children:[(0,y.jsx)("span",{style:{color:"red",marginRight:"10px",fontSize:"1rem"},children:n.filter((e=>e.reponse.length>0)).length}),"demande(s) repondue(s) sur",(0,y.jsx)("span",{style:{color:"red",margin:"7px",fontSize:"1rem"},children:n.length})," demande(s) envoy\xe9e(s)",(0,y.jsx)("span",{style:{color:"red",margin:"7px",fontSize:"1rem"},children:isNaN((100*n.filter((e=>e.reponse.length>0)).length/n.length).toFixed(0))?"":"Soit "+(100*n.filter((e=>e.reponse.length>0)).length/n.length).toFixed(0)+"%"})]})})})};var G=t(815103),H=t(51405),J=t(301550),Q=t(616529);const X=function(){const e=(0,i.v9)((e=>e.zone)),[n,t]=l.useState(""),[c,h]=l.useState(""),[x,p]=l.useState(),u=(0,i.v9)((e=>e.periodeStore)),[j,g]=l.useState(!1),[m,f]=l.useState(),[v,Z]=l.useState({message:"",valeur:!1}),{valeur:b,message:z}=v,[k,w]=l.useState();return l.useEffect((()=>{m&&(async()=>{g(!0);try{C.Z.post(A.V6+"/demandeAgentAll",m,A.vc).then((e=>{"token expired"===e.data?(localStorage.removeItem("auth"),window.location.replace("/login")):(w(e.data),g(!1))}))}catch(v){console.log(v)}})()}),[m]),(0,y.jsxs)(D.Z,{children:[b&&(0,y.jsx)(r.Z,{severity:"error",children:z}),(0,y.jsxs)(d.ZP,{container:!0,children:[(null===e||void 0===e?void 0:e.zone.length)>0&&(0,y.jsx)(d.ZP,{item:!0,lg:3,md:3,xs:12,sx:{marginTop:"5px"},children:(0,y.jsx)(s.Z,{value:n,setValue:t,options:e.zone,title:"R\xe9gions",propr:"denomination"})}),n&&(0,y.jsx)(d.ZP,{item:!0,lg:3,md:3,xs:12,sx:{paddingLeft:"5px",marginTop:"5px"},children:(0,y.jsx)(s.Z,{value:c,setValue:h,options:n.shop,title:"Shop",propr:"shop"})}),"success"===u.getPeriode&&u.periode.length>0&&(0,y.jsx)(d.ZP,{item:!0,lg:3,md:3,xs:12,children:(0,y.jsx)(R.Z,{sx:{minWidth:120,paddingLeft:"5px",marginTop:"5px",paddingRight:"5px"},children:(0,y.jsxs)(J.Z,{fullWidth:!0,children:[(0,y.jsx)(G.Z,{id:"demo-simple-select-label",children:"Mois"}),(0,y.jsxs)(Q.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:x,label:"Age",onChange:e=>{e.preventDefault(),"aucun"===e.target.value?p():p(e.target.value)},children:[(0,y.jsx)(H.Z,{value:"aucun",children:"Aucun"}),u.periode.map((e=>(0,y.jsx)(H.Z,{value:e._id,children:e._id},e._id)))]})]})})}),(0,y.jsx)(d.ZP,{item:!0,lg:3,sx:{marginTop:"5px",paddingLeft:"5px"},children:(0,y.jsxs)(o.Z,{color:"primary",variant:"contained",disabled:j,onClick:e=>(e=>{e.preventDefault();const t={region:n?n.idZone:void 0,idShop:c?c.idShop:void 0,paquet:x||void 0},{region:l,agent:i,paquet:s}=t;if(l||i||s){Z({valeur:!1,message:""});let e={};void 0!==t.idShop&&(e.idShop=t.idShop),void 0!==t.region&&(e.codeZone=t.region),void 0!==t.paquet&&(e.lot=t.paquet),f(e)}else Z({valeur:!0,message:"Veuillez choisir un critere de selection"})})(e),children:[(0,y.jsx)(a.Z,{fontSize:"small"})," ",(0,y.jsx)("span",{style:{marginLeft:"5px"},children:j?"Loading...":"Rechercher"})]})})]}),(0,y.jsx)(d.ZP,{container:!0,children:(0,y.jsx)(d.ZP,{item:!0,lg:12,children:k&&(0,y.jsxs)(d.ZP,{children:[(0,y.jsx)($,{listeDemande:k}),(0,y.jsx)(P.Z,{titres:[{id:0,label:"Graphique"},{id:1,label:"R\xe9gions"},{id:2,label:"Agents"}],components:[{id:0,component:(0,y.jsx)(S,{donner:k,recherche:m})},{id:1,component:(0,y.jsx)(N,{region:n,listeDemande:k})},{id:2,component:(0,y.jsx)(U,{listeDemande:k})}]})]})})})]})}},334811:(e,n,t)=>{t.d(n,{Z:()=>x});var l=t(747313),i=t(966149),s=t(896467),r=t(233604),d=t(850301),o=t(508586),a=t(261113),c=t(346417);const h=l.forwardRef((function(e,n){return(0,c.jsx)(d.Z,{direction:"up",ref:n,...e})}));const x=function(e){let{open:n,children:t,setOpen:l,title:d}=e;return(0,c.jsx)("div",{children:(0,c.jsxs)(i.Z,{open:n,TransitionComponent:h,keepMounted:!0,onClose:()=>{l(!1)},"aria-describedby":"alert-dialog-slide-description",children:[(0,c.jsxs)(r.Z,{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)(a.Z,{children:d}),(0,c.jsx)(o.Z,{fontSize:"small",color:"secondary",style:{cursor:"pointer"},onClick:()=>l(!1)})]}),(0,c.jsx)(s.Z,{children:t})]})})}}}]);